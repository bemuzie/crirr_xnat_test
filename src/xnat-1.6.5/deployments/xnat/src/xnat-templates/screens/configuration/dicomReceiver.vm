<!-- Title: DICOM -->
<div class="mgmt_container">
    <div id="dicom_petmr"></div>
    <div id="dicom_receiver_mgmt_div">
        <p>
            <label for="separatePETMR"><b>Separate PET-MR?</b></label>&nbsp;&nbsp;&nbsp;
            <select id="separatePETMR" name="separatePETMR" onchange="XNAT.app.PETMR.update();" disabled>
                <option value="">(SELECT)</option>
                <option value="petmr">Create as PET/MR session</option>
                <option value="pet">Create as PET session</option>
                <option value="separate">Separate into PET and MR sessions</option>
            </select>
            <small>Should data generated by PET-MR scanners be created as a single PET/MR imaging session, created as a single PET imaging session, or separated into PET and MR sessions?</small>
            <small>
                <span style="color:red;font-weight:bold;">Caution:</span>&nbsp;Changes to this setting will take effect immediately. Once PET/MR sessions have been split into separate PET and MR sessions, the XNAT
                system provides no direct means to reintegrate them into a single PET/MR session. You will usually need to resubmit the data to the system if you require a PET/MR session
                after the data have been split into separate sessions. Note that you can also configure this setting at the individual project level, so you may want to limit the session
                split settings to that level.
            </small>
        </p>

        <p>
            <label for="enableDicomReceiver"><b>DICOM receiver Enabled?</b></label>&nbsp;&nbsp;&nbsp;<input type="checkbox" id="enableDicomReceiver" onchange="window.dicomReceiverManager.dirtyForm();" disabled />
            <small>Should the DICOM receiver listen for connections?</small>
            <small><span style="color:red;font-weight:bold;">Caution:</span>&nbsp;Changes to this setting will take effect immediately. Before disabling the receiver, verify that there are no transmissions currently in progress.</small>
        </p>

        <p>The rest of this configuration comes from <i>WEB-INF/conf/dicom-import-context.xml</i> and is not currently editable here.  See the XNAT documentation for detailed information about configuration of the DICOM SCP.</p>

        <p>
            <b>Port Number:</b>&nbsp;&nbsp;&nbsp;<span id="dcmPortLabel"></span><input type="hidden" id="dcmPort"/>
            <small>This is the port number to which C-STORE SCUs (scanners and other clients sending data) should connect.</small>
        </p>

        <p>
            <b>DICOM AE Title(s):</b>&nbsp;&nbsp;&nbsp;<span id="dcmAeLabel"></span><input type="hidden" id="dcmAe"/>
            <small>These are the SCP Application Entity (AE) title(s).</small>
        </p>
    </div>
    <div class="buttons">
        <input type="button" class="submit" value="Save" name="eventSubmit_doPerform" id="dicomReceiver_save_button" onclick="window.dicomReceiverManager.saveTabSettings();"/>&nbsp;
        <input type="button" class="reset" value="Reset" name="eventSubmit_doReset" id="dicomReceiver_reset_button" onclick="window.dicomReceiverManager.resetForm();" disabled/>
    </div>
</div>

<script type="text/javascript" src="$content.getURI("scripts/config/MultiValueConfig.js")"></script>

<script type="text/javascript">
XNAT.app.PETMR = new MultiValueConfig("#separatePETMR", "/data/config/separatePETMR/config");

function configurationDicomReceiverTabChange(obj) {
    if(obj.newValue.get("href")=="#dicomReceiver") {
        if(window.dicomReceiverManager==undefined) {
				XNAT.app.PETMR.init();
                window.dicomReceiverManager = new SettingsTabManager('dicom_receiver_mgmt_div', 'dicomReceiver');
        }
    }
}

function addDicomReceiverMgmtMonitor(){
    if(window.configurationTabView.get("activeTab").get("href")=="#dicomReceiver") {
        if(window.dicomReceiverManager==undefined) {
				XNAT.app.PETMR.init();
                window.dicomReceiverManager = new SettingsTabManager('dicom_receiver_mgmt_div', 'dicomReceiver');
        }
    } else {
        window.configurationTabView.subscribe("activeTabChange", configurationDicomReceiverTabChange);
    }
}

YAHOO.util.Event.onDOMReady(addDicomReceiverMgmtMonitor);
putConfigurationControls('dicomReceiver', ['dcmPort', 'dcmAe', 'enableDicomReceiver']);
	
</script>
